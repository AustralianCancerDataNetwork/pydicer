<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Auto-segmentation Inference &amp; Analysis" href="AutoSegmentation.html" /><link rel="prev" title="Dose Metrics" href="DoseMetrics.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Dataset Preparation - PyDicer 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">PyDicer 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">PyDicer 0.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConvertingData.html">Converting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="VisualiseData.html">Visualise Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Radiomics.html">Compute Radiomics</a></li>
<li class="toctree-l1"><a class="reference internal" href="DoseMetrics.html">Dose Metrics</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Dataset Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="AutoSegmentation.html">Auto-segmentation Inference &amp; Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="nnUNet.html">nnUNet Data Preparation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="WorkingWithData.html">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="WorkingWithStructures.html">Working with Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="ObjectGeneration.html">Generating Data Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Code of Conduct</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tool.html">PyDicer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input.html">Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preprocess.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../convert.html">Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualise.html">Visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset.html">Dataset Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyse.html">Analyse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generate.html">Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nnunet.html">nnUNet</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Dataset-Preparation">
<h1>Dataset Preparation<a class="headerlink" href="#Dataset-Preparation" title="Permalink to this heading">#</a></h1>
<p>When working with real-world DICOM datasets, you will often need to tackle the task of cleaning the dataset. Often you will have several image series, structure set and even dose grids for each patient. However you typically want to select one relevant DICOM object in each category.</p>
<p>To help solve this, PyDicer provides a <code class="docutils literal notranslate"><span class="pre">dataset</span> <span class="pre">preparation</span></code> module which can be used to extract a subset of data from your overall set. Two example use cases where this might be useful are:</p>
<p><strong>Analysing dose to structures for a radiotherapy treatment</strong> You will want to extract the dose grid which was calculated from the plan used to treat the patient, as well as the linked structure set and planning CT image.</p>
<p><strong>Validating an Auto-segmentation tool</strong> A structure set may have been prepared for the purposes of validation and saved off with a specific <code class="docutils literal notranslate"><span class="pre">SeriesDescription</span></code>. You select the latest structure set with that description as well as the linked image series to perform the auto-segmentation validation.</p>
<p>As you will see in the examples below, you can provide your own logic to extract subsets of data using PyDicer.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">pydicer</span> <span class="kn">import</span> <span class="n">PyDicer</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pydicer
    <span class="kn">from</span> <span class="nn">pydicer</span> <span class="kn">import</span> <span class="n">PyDicer</span>

<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">pydicer.utils</span> <span class="kn">import</span> <span class="n">fetch_converted_test_data</span>
</pre></div>
</div>
</div>
<section id="Setup-PyDicer">
<h2>Setup PyDicer<a class="headerlink" href="#Setup-PyDicer" title="Permalink to this heading">#</a></h2>
<p>As in some other examples, we will use the HNSCC data prepared which has been preprepared and is downloaded into the <code class="docutils literal notranslate"><span class="pre">testdata_hnscc</span></code> directory. We also setup our <code class="docutils literal notranslate"><span class="pre">PyDicer</span></code> object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">working_directory</span> <span class="o">=</span> <span class="n">fetch_converted_test_data</span><span class="p">(</span><span class="s2">&quot;./testdata_hnscc&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;HNSCC&quot;</span><span class="p">)</span>

<span class="n">pydicer</span> <span class="o">=</span> <span class="n">PyDicer</span><span class="p">(</span><span class="n">working_directory</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Explore-data">
<h2>Explore data<a class="headerlink" href="#Explore-data" title="Permalink to this heading">#</a></h2>
<p>When we use the <code class="docutils literal notranslate"><span class="pre">read_converted_data</span></code> function, by default it will return all data which has been converted and is stored in the <code class="docutils literal notranslate"><span class="pre">testdata_hnscc/data</span></code> directory.</p>
<p>Let’s use this function and output the entire DataFrame of converted data to see what we have available in this dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pydicer</span><span class="o">.</span><span class="n">read_converted_data</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sop_instance_uid</th>
      <th>hashed_uid</th>
      <th>modality</th>
      <th>patient_id</th>
      <th>series_uid</th>
      <th>for_uid</th>
      <th>referenced_sop_instance_uid</th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.240263316258...</td>
      <td>72b0f9</td>
      <td>CT</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.261759476368...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/images/72b0f9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.264264397186...</td>
      <td>c16e76</td>
      <td>RTDOSE</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.233527028792...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.287865632112...</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/doses/c16e76</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.287865632112...</td>
      <td>664e96</td>
      <td>RTPLAN</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.137463901488...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.166429645421...</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/plans/664e96</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.166429645421...</td>
      <td>06e49c</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.243934637013...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.240263316258...</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/structures/0...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.334001018535...</td>
      <td>c4ffd0</td>
      <td>CT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.151938046710...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.120880328745...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/images/c4ffd0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.107072817915...</td>
      <td>8e0da9</td>
      <td>CT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.176143398282...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.216161306702...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/images/8e0da9</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.133948865586...</td>
      <td>ec4aec</td>
      <td>CT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.192899726585...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.216161306702...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/images/ec4aec</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.469610481459...</td>
      <td>33c44a</td>
      <td>CT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.244362210503...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.310630617866...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/images/33c44a</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.169033525924...</td>
      <td>833a74</td>
      <td>RTDOSE</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.279793773343...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.706719210726...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.470253980284...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/doses/833a74</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.267291308489...</td>
      <td>bf3fba</td>
      <td>RTDOSE</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.283706688235...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.566662631858...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.173917268454...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/doses/bf3fba</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.173917268454...</td>
      <td>6f7db7</td>
      <td>RTPLAN</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.120111576192...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.566662631858...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.323156708629...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/plans/6f7db7</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.470253980284...</td>
      <td>a6b346</td>
      <td>RTPLAN</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.318927873561...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.706719210726...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.403955456521...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/plans/a6b346</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.403955456521...</td>
      <td>cbbf5b</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.276897558084...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.120880328745...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.334001018535...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/structures/c...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.323156708629...</td>
      <td>6d2934</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.495627765798...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.310630617866...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.469610481459...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/structures/6...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.418136430763...</td>
      <td>b281ea</td>
      <td>CT</td>
      <td>HNSCC-01-0019</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.233510441938...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.290727775603...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0019/images/b281ea</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.242809596262...</td>
      <td>309e1a</td>
      <td>RTDOSE</td>
      <td>HNSCC-01-0019</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.777975715563...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.290727775603...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.254865609982...</td>
      <td>testdata_hnscc/data/HNSCC-01-0019/doses/309e1a</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.254865609982...</td>
      <td>57b99f</td>
      <td>RTPLAN</td>
      <td>HNSCC-01-0019</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.202542618630...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.290727775603...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.168221415040...</td>
      <td>testdata_hnscc/data/HNSCC-01-0019/plans/57b99f</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.168221415040...</td>
      <td>7cdcd9</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0019</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.103450757970...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.290727775603...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.418136430763...</td>
      <td>testdata_hnscc/data/HNSCC-01-0019/structures/7...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Prepare-dose-data">
<h2>Prepare dose data<a class="headerlink" href="#Prepare-dose-data" title="Permalink to this heading">#</a></h2>
<p>Here we use the <code class="docutils literal notranslate"><span class="pre">dataset</span> <span class="pre">preparation</span></code> module to extract the latest dose grid by date. We refer to this subset of data as <code class="docutils literal notranslate"><span class="pre">dose_project</span></code>.</p>
<p>We use the built in data extraction function, named <code class="docutils literal notranslate"><span class="pre">`rt_latest_dose</span></code> &lt;<a class="reference external" href="https://australiancancerdatanetwork.github.io/pydicer/dataset.html#pydicer.dataset.functions.rt_latest_dose">https://australiancancerdatanetwork.github.io/pydicer/dataset.html#pydicer.dataset.functions.rt_latest_dose</a>&gt;`__.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dose_project_name</span> <span class="o">=</span> <span class="s2">&quot;dose_project&quot;</span>
<span class="n">pydicer</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">dose_project_name</span><span class="p">,</span> <span class="s2">&quot;rt_latest_dose&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Once the cell above has finished running, the dataset has been prepared. You can explore the dataset in the <code class="docutils literal notranslate"><span class="pre">testdata_hnscc/dose_project</span></code> directory. Take notice of two things: - The <code class="docutils literal notranslate"><span class="pre">converted.csv</span></code> file stored from each patient now only includes the data objects which have been selected as part of this subset of data. - The data object folders are not actual folders, but symbolic links to the original data found in the <code class="docutils literal notranslate"><span class="pre">testdata_hnscc/data</span></code> directory. Like this, data isn’t duplicated but
the folder structure remains easy to navigate.</p>
<blockquote>
<div><p>Note: Symbolic links are supported on Unix-based (Linux, MacOS) operating systems only. These won’t work on Windows however you can still use the dataset prepared which is tracked in the converted csv files.</p>
</div></blockquote>
</section>
<section id="Load-prepared-Dataset">
<h2>Load prepared Dataset<a class="headerlink" href="#Load-prepared-Dataset" title="Permalink to this heading">#</a></h2>
<p>By supplying the <code class="docutils literal notranslate"><span class="pre">dataset_name</span></code> to the <code class="docutils literal notranslate"><span class="pre">read_converted_data</span></code> function, we obtain a DataFrame containing only the data objects part of that subset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_dose_project</span> <span class="o">=</span> <span class="n">pydicer</span><span class="o">.</span><span class="n">read_converted_data</span><span class="p">(</span><span class="n">dataset_name</span><span class="o">=</span><span class="n">dose_project_name</span><span class="p">)</span>
<span class="n">df_dose_project</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sop_instance_uid</th>
      <th>hashed_uid</th>
      <th>modality</th>
      <th>patient_id</th>
      <th>series_uid</th>
      <th>for_uid</th>
      <th>referenced_sop_instance_uid</th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.264264397186...</td>
      <td>c16e76</td>
      <td>RTDOSE</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.233527028792...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.287865632112...</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/doses/c16e76</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.287865632112...</td>
      <td>664e96</td>
      <td>RTPLAN</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.137463901488...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.166429645421...</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/plans/664e96</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.166429645421...</td>
      <td>06e49c</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.243934637013...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.240263316258...</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/structures/0...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.240263316258...</td>
      <td>72b0f9</td>
      <td>CT</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.261759476368...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/images/72b0f9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.169033525924...</td>
      <td>833a74</td>
      <td>RTDOSE</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.279793773343...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.706719210726...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.470253980284...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/doses/833a74</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.470253980284...</td>
      <td>a6b346</td>
      <td>RTPLAN</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.318927873561...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.706719210726...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.403955456521...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/plans/a6b346</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.403955456521...</td>
      <td>cbbf5b</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.276897558084...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.120880328745...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.334001018535...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/structures/c...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.334001018535...</td>
      <td>c4ffd0</td>
      <td>CT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.151938046710...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.120880328745...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/images/c4ffd0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.242809596262...</td>
      <td>309e1a</td>
      <td>RTDOSE</td>
      <td>HNSCC-01-0019</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.777975715563...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.290727775603...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.254865609982...</td>
      <td>testdata_hnscc/data/HNSCC-01-0019/doses/309e1a</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.254865609982...</td>
      <td>57b99f</td>
      <td>RTPLAN</td>
      <td>HNSCC-01-0019</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.202542618630...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.290727775603...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.168221415040...</td>
      <td>testdata_hnscc/data/HNSCC-01-0019/plans/57b99f</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.168221415040...</td>
      <td>7cdcd9</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0019</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.103450757970...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.290727775603...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.418136430763...</td>
      <td>testdata_hnscc/data/HNSCC-01-0019/structures/7...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.418136430763...</td>
      <td>b281ea</td>
      <td>CT</td>
      <td>HNSCC-01-0019</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.233510441938...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.290727775603...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0019/images/b281ea</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Notice that we now only have one of each data object modality in our <code class="docutils literal notranslate"><span class="pre">dose_project</span></code> subset. We are now ready to work with that subset (e.g. extract dose metrics).</p>
</section>
<section id="Prepare-Structure-Dataset">
<h2>Prepare Structure Dataset<a class="headerlink" href="#Prepare-Structure-Dataset" title="Permalink to this heading">#</a></h2>
<p>In the next example, we are only want to extract structure sets and their associated images. This might be useful when training or validating an auto-segmentation model.</p>
<p>In this example, we not only select the latest structure set by date, but we specify the <code class="docutils literal notranslate"><span class="pre">StudyDescription</span></code> values of the DICOM metadata of the data objects we want to select. To achieve this, we use the build in <code class="docutils literal notranslate"><span class="pre">`rt_latest_struct</span></code> &lt;<a class="reference external" href="https://australiancancerdatanetwork.github.io/pydicer/dataset.html#pydicer.dataset.functions.rt_latest_struct">https://australiancancerdatanetwork.github.io/pydicer/dataset.html#pydicer.dataset.functions.rt_latest_struct</a>&gt;`__ function.</p>
<p>Observe the output of the following cell and explore the <code class="docutils literal notranslate"><span class="pre">testdata_hnscc</span></code> directory. We not have one structure set and the linked image for each patient.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the dataset name and the study description values to match</span>
<span class="n">structure_project_name</span> <span class="o">=</span> <span class="s2">&quot;structure_project&quot;</span>
<span class="n">series_descriptions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;RT SIMULATION&quot;</span>
<span class="p">]</span>


<span class="c1"># Prepare the subset of data</span>
<span class="n">pydicer</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span>
    <span class="n">structure_project_name</span><span class="p">,</span>
    <span class="s2">&quot;rt_latest_struct&quot;</span><span class="p">,</span>
    <span class="n">StudyDescription</span><span class="o">=</span><span class="n">series_descriptions</span>
<span class="p">)</span>

<span class="c1"># Load the data subset and display the DataFrame</span>
<span class="n">df_structure_project</span> <span class="o">=</span> <span class="n">pydicer</span><span class="o">.</span><span class="n">read_converted_data</span><span class="p">(</span><span class="n">dataset_name</span><span class="o">=</span><span class="n">structure_project_name</span><span class="p">)</span>
<span class="n">df_structure_project</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sop_instance_uid</th>
      <th>hashed_uid</th>
      <th>modality</th>
      <th>patient_id</th>
      <th>series_uid</th>
      <th>for_uid</th>
      <th>referenced_sop_instance_uid</th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.166429645421...</td>
      <td>06e49c</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.243934637013...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.240263316258...</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/structures/0...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.240263316258...</td>
      <td>72b0f9</td>
      <td>CT</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.261759476368...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/images/72b0f9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.403955456521...</td>
      <td>cbbf5b</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.276897558084...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.120880328745...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.334001018535...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/structures/c...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.334001018535...</td>
      <td>c4ffd0</td>
      <td>CT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.151938046710...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.120880328745...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/images/c4ffd0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.168221415040...</td>
      <td>7cdcd9</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0019</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.103450757970...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.290727775603...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.418136430763...</td>
      <td>testdata_hnscc/data/HNSCC-01-0019/structures/7...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.418136430763...</td>
      <td>b281ea</td>
      <td>CT</td>
      <td>HNSCC-01-0019</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.233510441938...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.290727775603...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0019/images/b281ea</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Prepare-Dataset-from-DataFrame">
<h2>Prepare Dataset from DataFrame<a class="headerlink" href="#Prepare-Dataset-from-DataFrame" title="Permalink to this heading">#</a></h2>
<p>In some scenarios, you may want to simply perform some filtering on the DataFrame returned by the <code class="docutils literal notranslate"><span class="pre">read_converted_data</span></code> function and generate a subset of data based on that.</p>
<p>In the following cell, a subset of data named <code class="docutils literal notranslate"><span class="pre">image_project</span></code> is generated by filtering the DataFrame to keep only <code class="docutils literal notranslate"><span class="pre">CT</span></code> images.</p>
<p>After running the following cell, explore the <code class="docutils literal notranslate"><span class="pre">testdata_hnscc/image_project</span></code> directory to confirm that only image objects were selected.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the converted DataFrame and filter only CT images</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pydicer</span><span class="o">.</span><span class="n">read_converted_data</span><span class="p">()</span>
<span class="n">df_ct</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">modality</span><span class="o">==</span><span class="s2">&quot;CT&quot;</span><span class="p">]</span>

<span class="c1"># Prepare a data subset using this filtered DataFrame</span>
<span class="n">image_project_name</span> <span class="o">=</span> <span class="s2">&quot;image_project&quot;</span>
<span class="n">pydicer</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">prepare_from_dataframe</span><span class="p">(</span><span class="n">image_project_name</span><span class="p">,</span> <span class="n">df_ct</span><span class="p">)</span>

<span class="c1"># Load the data subset and display the DataFrame</span>
<span class="n">df_image_project</span> <span class="o">=</span> <span class="n">pydicer</span><span class="o">.</span><span class="n">read_converted_data</span><span class="p">(</span><span class="n">dataset_name</span><span class="o">=</span><span class="n">image_project_name</span><span class="p">)</span>
<span class="n">df_image_project</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sop_instance_uid</th>
      <th>hashed_uid</th>
      <th>modality</th>
      <th>patient_id</th>
      <th>series_uid</th>
      <th>for_uid</th>
      <th>referenced_sop_instance_uid</th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.240263316258...</td>
      <td>72b0f9</td>
      <td>CT</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.261759476368...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/images/72b0f9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.334001018535...</td>
      <td>c4ffd0</td>
      <td>CT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.151938046710...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.120880328745...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/images/c4ffd0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.107072817915...</td>
      <td>8e0da9</td>
      <td>CT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.176143398282...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.216161306702...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/images/8e0da9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.133948865586...</td>
      <td>ec4aec</td>
      <td>CT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.192899726585...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.216161306702...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/images/ec4aec</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.469610481459...</td>
      <td>33c44a</td>
      <td>CT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.244362210503...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.310630617866...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/images/33c44a</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.418136430763...</td>
      <td>b281ea</td>
      <td>CT</td>
      <td>HNSCC-01-0019</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.233510441938...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.290727775603...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0019/images/b281ea</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Define-Custom-Preparation-Function">
<h2>Define Custom Preparation Function<a class="headerlink" href="#Define-Custom-Preparation-Function" title="Permalink to this heading">#</a></h2>
<p>In more complex use cases you may want to define your own logic for extracting data objects into a subset. For example, you may have an additional DataFrame containing treatment start dates of patients, and you would like to select the dose grid, structure set and image series which are closest to that date.</p>
<p>In the following cell, we preare a <code class="docutils literal notranslate"><span class="pre">clinical_project</span></code> subset of data. We create a dummy set of clinical tabular data <code class="docutils literal notranslate"><span class="pre">df_clinical</span></code>. This stores each patient’s stage and RT start date.</p>
<p>We use the information in <code class="docutils literal notranslate"><span class="pre">df_clinical</span></code>, to select patients who are stage 1-3 along with the data objects where the dose grid date is nearest to their treatment start date.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define some dummy clinical data</span>
<span class="n">df_clinical</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">{</span>
        <span class="s2">&quot;patient_id&quot;</span><span class="p">:</span> <span class="s2">&quot;HNSCC-01-0199&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;rt_start_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2002-10-28&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;patient_id&quot;</span><span class="p">:</span> <span class="s2">&quot;HNSCC-01-0176&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;rt_start_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2009-03-02&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;patient_id&quot;</span><span class="p">:</span> <span class="s2">&quot;HNSCC-01-0019&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;rt_start_date&quot;</span><span class="p">:</span> <span class="s2">&quot;1998-07-10&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">])</span>

<span class="c1"># Convert date to a datetime object</span>
<span class="n">df_clinical</span><span class="p">[</span><span class="s1">&#39;rt_start_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_clinical</span><span class="p">[</span><span class="s1">&#39;rt_start_date&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import some pydicer utility functions that we&#39;ll need</span>
<span class="kn">from</span> <span class="nn">pydicer.utils</span> <span class="kn">import</span> <span class="n">load_object_metadata</span><span class="p">,</span> <span class="n">determine_dcm_datetime</span>

<span class="c1"># Define a function which accept the converted DataFrame as input and returns a filtered DataFrame</span>
<span class="c1"># of objects to keep in the data subset. This function also takes the clinical DataFrame as input.</span>
<span class="k">def</span> <span class="nf">extract_clinical_data</span><span class="p">(</span><span class="n">df_data</span><span class="p">,</span> <span class="n">df_clinical</span><span class="p">):</span>

    <span class="c1"># Merge the clinical data with our data objects</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_data</span><span class="p">,</span> <span class="n">df_clinical</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;patient_id&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>

    <span class="c1"># Filter out patients who aren&#39;t stage 1-3</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">stage</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">stage</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)]</span>

    <span class="c1"># Determine the date of each data object</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;obj_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">determine_dcm_datetime</span><span class="p">(</span><span class="n">load_object_metadata</span><span class="p">(</span><span class="n">row</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># List to track row indicies we will keep</span>
    <span class="n">keep_rows</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Sort their dose grids by descending order, so we can select the first (latest)</span>
    <span class="c1"># dose grid and link the structure set and image series to use for the data subset.</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;obj_date&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Loop the data by patient to select the data objects</span>
    <span class="k">for</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">df_pat</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;patient_id&quot;</span><span class="p">):</span>

        <span class="n">df_doses</span> <span class="o">=</span> <span class="n">df_pat</span><span class="p">[</span><span class="n">df_pat</span><span class="o">.</span><span class="n">modality</span><span class="o">==</span><span class="s2">&quot;RTDOSE&quot;</span><span class="p">]</span>

        <span class="c1"># If there are no dose grid, we skip this patient</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_doses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Otherwise, we select the first dose grid (which is the latest since they are sorted)</span>
        <span class="c1"># to keep</span>
        <span class="n">dose_row</span> <span class="o">=</span> <span class="n">df_doses</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">df_linked_structs</span> <span class="o">=</span> <span class="n">pydicer</span><span class="o">.</span><span class="n">get_structures_linked_to_dose</span><span class="p">(</span><span class="n">dose_row</span><span class="p">)</span>

        <span class="c1"># Skip patient if no linked structure sets are found</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_linked_structs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Finally, find the image linked to the structure set</span>
        <span class="n">struct_row</span> <span class="o">=</span> <span class="n">df_linked_structs</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">df_linked_images</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">sop_instance_uid</span><span class="o">==</span><span class="n">struct_row</span><span class="o">.</span><span class="n">referenced_sop_instance_uid</span><span class="p">]</span>

        <span class="c1"># Skip if no images found</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_linked_images</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">image_row</span> <span class="o">=</span> <span class="n">df_linked_images</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Store the indcies of these data objects</span>
        <span class="n">keep_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image_row</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">keep_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">struct_row</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">keep_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dose_row</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># Return only the rows of the data objects we want to keep in the data subset</span>
    <span class="k">return</span> <span class="n">df_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">keep_rows</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clinical_project_name</span> <span class="o">=</span> <span class="s2">&quot;clinical&quot;</span>

<span class="c1"># Prepare the subset of data using our custom function</span>
<span class="n">pydicer</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span>
    <span class="n">clinical_project_name</span><span class="p">,</span>
    <span class="n">extract_clinical_data</span><span class="p">,</span>
    <span class="n">df_clinical</span><span class="o">=</span><span class="n">df_clinical</span>
<span class="p">)</span>

<span class="c1"># Load the data subset and display the DataFrame</span>
<span class="n">df_clinical_project</span> <span class="o">=</span> <span class="n">pydicer</span><span class="o">.</span><span class="n">read_converted_data</span><span class="p">(</span><span class="n">dataset_name</span><span class="o">=</span><span class="n">clinical_project_name</span><span class="p">)</span>
<span class="n">df_clinical_project</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sop_instance_uid</th>
      <th>hashed_uid</th>
      <th>modality</th>
      <th>patient_id</th>
      <th>series_uid</th>
      <th>for_uid</th>
      <th>referenced_sop_instance_uid</th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.240263316258...</td>
      <td>72b0f9</td>
      <td>CT</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.261759476368...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/images/72b0f9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.166429645421...</td>
      <td>06e49c</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.243934637013...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.240263316258...</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/structures/0...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.264264397186...</td>
      <td>c16e76</td>
      <td>RTDOSE</td>
      <td>HNSCC-01-0199</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.233527028792...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.870916135819...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.287865632112...</td>
      <td>testdata_hnscc/data/HNSCC-01-0199/doses/c16e76</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.334001018535...</td>
      <td>c4ffd0</td>
      <td>CT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.151938046710...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.120880328745...</td>
      <td>NaN</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/images/c4ffd0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.403955456521...</td>
      <td>cbbf5b</td>
      <td>RTSTRUCT</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.276897558084...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.120880328745...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.334001018535...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/structures/c...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.169033525924...</td>
      <td>833a74</td>
      <td>RTDOSE</td>
      <td>HNSCC-01-0176</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.279793773343...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.706719210726...</td>
      <td>1.3.6.1.4.1.14519.5.2.1.1706.8040.470253980284...</td>
      <td>testdata_hnscc/data/HNSCC-01-0176/doses/833a74</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="AutoSegmentation.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Auto-segmentation Inference &amp; Analysis</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="DoseMetrics.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Dose Metrics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Ingham Medical Physics
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Dataset Preparation</a><ul>
<li><a class="reference internal" href="#Setup-PyDicer">Setup PyDicer</a></li>
<li><a class="reference internal" href="#Explore-data">Explore data</a></li>
<li><a class="reference internal" href="#Prepare-dose-data">Prepare dose data</a></li>
<li><a class="reference internal" href="#Load-prepared-Dataset">Load prepared Dataset</a></li>
<li><a class="reference internal" href="#Prepare-Structure-Dataset">Prepare Structure Dataset</a></li>
<li><a class="reference internal" href="#Prepare-Dataset-from-DataFrame">Prepare Dataset from DataFrame</a></li>
<li><a class="reference internal" href="#Define-Custom-Preparation-Function">Define Custom Preparation Function</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>